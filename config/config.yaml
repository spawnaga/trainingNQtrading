# NQ Trading System Configuration

data:
  csv_folder: "data/csv"
  sequence_length: 60  # Number of bars for lookback
  train_split: 0.7
  val_split: 0.15
  test_split: 0.15
  features:
    - open
    - high
    - low
    - close
    - volume
  timeframes:
    - 1m
    - 5m
    - 15m

model:
  transformer:
    d_model: 256
    n_heads: 8
    n_layers: 4
    d_ff: 1024
    dropout: 0.1
    max_seq_length: 512

  profit_agent:
    hidden_dim: 128
    n_layers: 2

  risk_agent:
    hidden_dim: 64
    n_layers: 2

  duration_agent:
    hidden_dim: 64
    n_layers: 2
    num_classes: 3  # scalp, intraday, swing

  meta_agent:
    hidden_dim: 256
    n_heads: 4

training:
  batch_size: 64
  epochs: 100
  learning_rate: 0.0001
  weight_decay: 0.0001
  gradient_clip: 1.0
  device: "cuda"  # cuda or cpu
  mixed_precision: true
  checkpoint_dir: "checkpoints"
  log_dir: "logs"

  # Multi-GPU settings (for 2x 5090)
  distributed:
    enabled: false  # Set to true for multi-GPU
    backend: "nccl"  # nccl for Linux, gloo for Windows
    world_size: 2  # Number of GPUs
    num_workers: 4  # DataLoader workers per GPU

genetic:
  population_size: 50
  generations: 100
  mutation_rate: 0.1
  crossover_rate: 0.7
  tournament_size: 3
  elite_size: 5

  # Hyperparameter search space
  search_space:
    d_model: [128, 256, 512]
    n_heads: [4, 8, 16]
    n_layers: [2, 4, 6]
    dropout: [0.05, 0.1, 0.2]
    learning_rate: [0.00001, 0.0001, 0.001]
    batch_size: [32, 64, 128]

trading:
  ib_host: "127.0.0.1"
  ib_port: 4002
  client_id: 1
  paper_client_id: 2
  symbol: "NQ"
  exchange: "CME"
  currency: "USD"
  sec_type: "FUT"

  paper_trading: true

  # Risk Management
  max_position: 2  # Maximum number of contracts
  risk_per_trade: 0.02  # 2% of account per trade
  max_daily_loss: 0.05  # 5% max daily drawdown
  atr_multiplier: 2.0  # For stop-loss calculation
  atr_period: 14

  # Order Settings
  order_timeout: 30  # seconds
  retry_attempts: 3

  # Session Times (Eastern Time)
  session_start: "18:00"
  session_end: "17:00"

backtest:
  initial_capital: 100000
  commission: 2.25  # Per contract per side
  slippage: 0.25  # Points
  margin_per_contract: 15000
